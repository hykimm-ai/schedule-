
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
<title>ğŸ—“ï¸ ì§€ìš° ì‹œê°„í‘œ</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;900&family=Gmarket+Sans:wght@300;500;700&display=swap" rel="stylesheet">
<style>
Â  :root { --bg:#f7f3ee; --card:#ffffff; --text:#1a1a2e; --shadow:0 4px 20px rgba(0,0,0,0.08); }
Â  * { box-sizing:border-box; margin:0; padding:0; }
Â  body { font-family:'Noto Sans KR',sans-serif; background:var(--bg); color:var(--text); min-height:100vh; padding:20px 16px 100px; }

Â  header { text-align:center; margin-bottom:24px; }
Â  header h1 { font-family:'Gmarket Sans',sans-serif; font-size:2rem; font-weight:700; }
Â  header pÂ  { font-size:0.85rem; color:#888; margin-top:4px; }

Â  .controls { display:flex; justify-content:center; gap:10px; margin-bottom:20px; flex-wrap:wrap; }
Â  .ctrl-btn { background:white; border:2px solid #ddd; border-radius:50px; padding:8px 20px; font-family:'Noto Sans KR',sans-serif; font-size:0.9rem; font-weight:600; cursor:pointer; transition:all 0.2s; color:var(--text); }
Â  .ctrl-btn:hover,.ctrl-btn.active { background:var(--text); color:white; border-color:var(--text); }

Â  .legend { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-bottom:24px; }
Â  .legend-item { display:flex; align-items:center; gap:6px; font-size:0.78rem; font-weight:600; background:white; padding:5px 12px; border-radius:50px; box-shadow:0 2px 8px rgba(0,0,0,0.06); }
Â  .legend-dot { width:12px; height:12px; border-radius:50%; flex-shrink:0; }

Â  .days-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr)); gap:16px; max-width:1200px; margin:0 auto; }
Â  .day-card { background:var(--card); border-radius:20px; padding:20px; box-shadow:var(--shadow); transition:transform 0.2s; }
Â  .day-card:hover { transform:translateY(-2px); }
Â  .day-title { font-family:'Gmarket Sans',sans-serif; font-size:1.3rem; font-weight:700; margin-bottom:14px; display:flex; align-items:center; gap:8px; }
Â  .day-badge { width:36px; height:36px; border-radius:10px; background:var(--text); color:white; display:flex; align-items:center; justify-content:center; font-size:0.85rem; font-weight:900; flex-shrink:0; }

Â  .school-row { display:flex; align-items:center; gap:10px; border-radius:12px; padding:10px 14px; margin-bottom:8px; font-weight:700; color:white; position:relative; }
Â  .school-row .school-time { font-size:0.9rem; opacity:0.85; margin-left:auto; font-weight:600; }

Â  .block { display:flex; align-items:center; gap:12px; border-radius:12px; padding:10px 14px; margin-bottom:8px; font-weight:600; position:relative; overflow:hidden; }
Â  .block::before { content:''; position:absolute; inset:0; background:rgba(255,255,255,0.12); border-radius:inherit; }
Â  .block-name { font-size:1rem; font-weight:700; flex:1; position:relative; }
Â  .block-time { font-size:0.82rem; opacity:0.9; white-space:nowrap; position:relative; font-weight:600; }
Â  .block-icon { font-size:1.1rem; position:relative; }

Â  /* edit mode hover */
Â  .edit-active .block, .edit-active .school-row { cursor:pointer; }
Â  .edit-active .block:hover, .edit-active .school-row:hover { filter:brightness(1.1); }
Â  .edit-active .add-btn { display:flex !important; }

Â  .add-btn { display:none !important; align-items:center; justify-content:center; gap:6px; border:2px dashed rgba(0,0,0,0.2); border-radius:12px; padding:9px 14px; margin-bottom:8px; background:transparent; width:100%; font-family:'Noto Sans KR',sans-serif; font-size:0.9rem; font-weight:600; color:rgba(0,0,0,0.4); cursor:pointer; transition:all 0.2s; }
Â  .add-btn:hover { border-color:rgba(0,0,0,0.5); color:rgba(0,0,0,0.65); }

Â  /* font sizes */
Â  body.size-lg .block-name { font-size:1.25rem; }
Â  body.size-lg .block-time { font-size:1rem; }
Â  body.size-lg .school-row { font-size:1.1rem; }
Â  body.size-lg .day-titleÂ  { font-size:1.5rem; }
Â  body.size-lg .block { padding:13px 16px; }
Â  body.size-xl .block-name { font-size:1.55rem; }
Â  body.size-xl .block-time { font-size:1.15rem; }
Â  body.size-xl .school-row { font-size:1.25rem; padding:13px 16px; }
Â  body.size-xl .day-titleÂ  { font-size:1.7rem; }
Â  body.size-xl .block { padding:16px 18px; margin-bottom:10px; }
Â  body.size-xl .days-gridÂ  { grid-template-columns:1fr; max-width:600px; }

Â  @media(max-width:480px){ .days-grid{ grid-template-columns:1fr; } header h1{ font-size:1.6rem; } }

Â  .edit-fab { position:fixed; bottom:24px; right:24px; width:56px; height:56px; background:var(--text); color:white; border:none; border-radius:50%; font-size:1.4rem; cursor:pointer; box-shadow:0 4px 20px rgba(0,0,0,0.25); display:flex; align-items:center; justify-content:center; transition:all 0.2s; z-index:100; }
Â  .edit-fab:hover { transform:scale(1.1); }
Â  .edit-fab.active { background:#e74c3c; }

Â  .edit-banner { display:none; background:#1a1a2e; color:white; text-align:center; padding:10px; font-size:0.85rem; font-weight:600; position:sticky; top:0; z-index:50; border-radius:0 0 16px 16px; margin-bottom:16px; }
Â  .edit-banner.show { display:block; }
Â  .edit-banner span { color:#FFD700; }

Â  /* modals */
Â  .overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:200; align-items:center; justify-content:center; padding:16px; }
Â  .overlay.show { display:flex; }
Â  .modal { background:white; border-radius:24px; padding:28px 24px; width:100%; max-width:380px; box-shadow:0 20px 60px rgba(0,0,0,0.2); max-height:90vh; overflow-y:auto; }
Â  .modal h2 { font-size:1.2rem; margin-bottom:6px; }
Â  .modal > p { font-size:0.83rem; color:#888; margin-bottom:18px; }
Â  .modal label { display:block; font-size:0.82rem; font-weight:700; color:#555; margin-bottom:5px; }
Â  .modal input { width:100%; border:2px solid #eee; border-radius:12px; padding:11px 14px; font-size:0.95rem; font-family:inherit; outline:none; transition:border 0.2s; margin-bottom:12px; }
Â  .modal input:focus { border-color:var(--text); }
Â  .modal-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:12px; }
Â  .modal-row > div { display:flex; flex-direction:column; }
Â  .modal-row input { margin-bottom:0; }
Â  .btn-row { display:flex; gap:8px; margin-top:6px; flex-wrap:wrap; }
Â  .btn-primary { flex:1; background:var(--text); color:white; border:none; border-radius:12px; padding:13px; font-size:0.95rem; font-family:inherit; font-weight:700; cursor:pointer; }
Â  .btn-secondary { flex:1; background:#f0f0f0; color:#555; border:none; border-radius:12px; padding:13px; font-size:0.95rem; font-family:inherit; font-weight:600; cursor:pointer; }
Â  .btn-danger { background:#fee; color:#e74c3c; border:none; border-radius:12px; padding:13px 16px; font-size:0.95rem; font-family:inherit; font-weight:600; cursor:pointer; }
Â  .error-msg { color:#e74c3c; font-size:0.82rem; margin-top:-8px; margin-bottom:10px; }

Â  .color-grid { display:grid; grid-template-columns:repeat(5,1fr); gap:8px; margin-bottom:14px; }
Â  .color-opt { height:32px; border-radius:8px; border:3px solid transparent; cursor:pointer; transition:transform 0.15s; }
Â  .color-opt:hover { transform:scale(1.1); }
Â  .color-opt.selected { border-color:#1a1a2e; transform:scale(1.12); }

Â  .save-toast { position:fixed; bottom:90px; left:50%; transform:translateX(-50%) translateY(20px); background:#2ecc71; color:white; padding:10px 24px; border-radius:50px; font-size:0.9rem; font-weight:700; opacity:0; transition:all 0.3s; z-index:300; white-space:nowrap; }
Â  .save-toast.show { opacity:1; transform:translateX(-50%) translateY(0); }

Â  /* â”€â”€ VIEW TOGGLE â”€â”€ */
Â  .view-toggle { display:flex; justify-content:center; gap:8px; margin-bottom:20px; }
Â  .view-btn { background:white; border:2px solid #ddd; border-radius:50px; padding:8px 22px; font-family:'Noto Sans KR',sans-serif; font-size:0.9rem; font-weight:600; cursor:pointer; transition:all 0.2s; color:var(--text); }
Â  .view-btn:hover,.view-btn.active { background:var(--text); color:white; border-color:var(--text); }

Â  /* â”€â”€ WEEKLY TABLE VIEW â”€â”€ */
Â  .week-wrap { overflow-x:auto; -webkit-overflow-scrolling:touch; padding-bottom:8px; }
Â  .week-table { display:grid; grid-template-columns:repeat(5,minmax(160px,1fr)); gap:12px; min-width:820px; max-width:1400px; margin:0 auto; }
Â  .week-col { background:var(--card); border-radius:16px; padding:14px 12px; box-shadow:var(--shadow); }
Â  .week-day-title { font-family:'Gmarket Sans',sans-serif; font-size:1rem; font-weight:700; text-align:center; margin-bottom:12px; display:flex; align-items:center; justify-content:center; gap:6px; }
Â  .week-badge { width:28px; height:28px; border-radius:8px; background:var(--text); color:white; display:flex; align-items:center; justify-content:center; font-size:0.75rem; font-weight:900; flex-shrink:0; }
Â  .week-school { display:flex; align-items:center; justify-content:center; gap:6px; border-radius:10px; padding:7px 10px; margin-bottom:7px; font-weight:700; color:white; font-size:0.82rem; }
Â  .week-block { display:flex; flex-direction:column; border-radius:10px; padding:8px 10px; margin-bottom:7px; font-weight:600; position:relative; overflow:hidden; }
Â  .week-block::before { content:''; position:absolute; inset:0; background:rgba(255,255,255,0.12); border-radius:inherit; }
Â  .week-block-top { display:flex; align-items:center; gap:5px; position:relative; }
Â  .week-block-name { font-size:0.88rem; font-weight:700; flex:1; }
Â  .week-block-icon { font-size:0.95rem; }
Â  .week-block-time { font-size:0.72rem; opacity:0.85; position:relative; margin-top:3px; font-weight:600; }
Â  .edit-active .week-block, .edit-active .week-school { cursor:pointer; }
Â  .edit-active .week-block:hover, .edit-active .week-school:hover { filter:brightness(1.1); }
Â  body.size-lg .week-block-name { font-size:1rem; }
Â  body.size-lg .week-block-time { font-size:0.82rem; }
Â  body.size-lg .week-table { grid-template-columns:repeat(5,minmax(190px,1fr)); min-width:980px; }
Â  body.size-xl .week-block-name { font-size:1.1rem; }
Â  body.size-xl .week-block-time { font-size:0.9rem; }
Â  body.size-xl .week-table { grid-template-columns:repeat(5,minmax(220px,1fr)); min-width:1140px; }

Â  /* â”€â”€ BOTTOM BAR â”€â”€ */
Â  .bottom-bar { margin-top:36px; padding:24px 16px 16px; border-top:2px solid rgba(0,0,0,0.07); max-width:1200px; margin-left:auto; margin-right:auto; }
Â  .bottom-bar .view-toggle { margin-bottom:16px; }

Â  /* â”€â”€ size-xl TIME 2x â”€â”€ */
Â  body.size-xl .block-time { font-size:1.4rem !important; }
Â  body.size-xl .school-row .school-time { font-size:1.4rem !important; }
Â  body.size-xl .week-block-time { font-size:1.3rem !important; }
</style>
</head>
<body>

<div class="edit-banner" id="editBanner">
Â  âœï¸ í¸ì§‘ ëª¨ë“œ í™œì„±í™” &mdash; ë¸”ë¡ì„ ëˆŒëŸ¬ ìˆ˜ì •í•˜ê±°ë‚˜ <span>+ ì¼ì • ì¶”ê°€</span> ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš” &nbsp;|&nbsp; <a href="#" onclick="exitEdit();return false;" style="color:#FF6B6B;text-decoration:none;font-weight:700;">ğŸ”’ ì ê¸ˆ</a>
</div>

<header>
Â  <h1>ğŸ—“ï¸ ì§€ìš° ì‹œê°„í‘œ</h1>
Â  <p>í•™êµ Â· í•™ì› ì£¼ê°„ ì¼ì •</p>
</header>

<div class="controls">
Â  <button class="ctrl-btn active" onclick="setSize('normal',this)">ë³´í†µ</button>
Â  <button class="ctrl-btn" onclick="setSize('lg',this)">í¬ê²Œ ğŸ”</button>
Â  <button class="ctrl-btn" onclick="setSize('xl',this)">ë§¤ìš° í¬ê²Œ ğŸ‘´ğŸ‘µ</button>
</div>

<!-- Card view -->
<div class="days-grid" id="schedule"></div>

<!-- Weekly view -->
<div class="week-wrap" id="weekWrap" style="display:none">
Â  <div class="week-table" id="weekTable"></div>
</div>

<!-- Bottom controls -->
<div class="bottom-bar">
Â  <div class="view-toggle">
Â  Â  <button class="view-btn active" id="vCard" onclick="setView('card',this)">ğŸ“‹ ì¹´ë“œ ë³´ê¸°</button>
Â  Â  <button class="view-btn" id="vWeek" onclick="setView('week',this)">ğŸ“… í•œëˆˆì— ë³´ê¸°</button>
Â  </div>
Â  <div class="legend" id="legend"></div>
</div>

<div class="save-toast" id="toast">âœ… ì €ì¥ëì–´ìš”!</div>

<button class="edit-fab" id="editFab" onclick="toggleEdit()" title="í¸ì§‘">âœï¸</button>

<!-- PW MODAL -->
<div class="overlay" id="pwOverlay">
Â  <div class="modal">
Â  Â  <h2>ğŸ” í¸ì§‘ ëª¨ë“œ</h2>
Â  Â  <p>ë¶€ëª¨ë‹˜ ì „ìš© ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”</p>
Â  Â  <label>ë¹„ë°€ë²ˆí˜¸</label>
Â  Â  <input type="password" id="pwInput" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" onkeydown="if(event.key==='Enter')checkPw()">
Â  Â  <div class="error-msg" id="pwError"></div>
Â  Â  <div class="btn-row">
Â  Â  Â  <button class="btn-primary" onclick="checkPw()">í™•ì¸</button>
Â  Â  Â  <button class="btn-secondary" onclick="closeOverlay('pwOverlay')">ì·¨ì†Œ</button>
Â  Â  </div>
Â  </div>
</div>

<!-- EDIT MODAL -->
<div class="overlay" id="editOverlay">
Â  <div class="modal">
Â  Â  <h2>âœï¸ ì¼ì • ìˆ˜ì •</h2>
Â  Â  <p>ë‚´ìš©ì„ ë³€ê²½í•˜ê³  ì €ì¥í•˜ì„¸ìš”</p>
Â  Â  <label>í™œë™ ì´ë¦„</label>
Â  Â  <input type="text" id="editName" placeholder="ì˜ˆ: ì˜ì–´">
Â  Â  <label>ì•„ì´ì½˜ (ì´ëª¨ì§€)</label>
Â  Â  <input type="text" id="editIcon" placeholder="ì˜ˆ: ğŸ“š">
Â  Â  <label>ì‹œê°„</label>
Â  Â  <div class="modal-row">
Â  Â  Â  <div><label style="font-size:0.75rem;color:#999;margin-bottom:4px">ì‹œì‘</label><input type="text" id="editStart" placeholder="1:30"></div>
Â  Â  Â  <div><label style="font-size:0.75rem;color:#999;margin-bottom:4px">ì¢…ë£Œ</label><input type="text" id="editEnd" placeholder="2:30 (ì—†ìœ¼ë©´ ë¹ˆì¹¸)"></div>
Â  Â  </div>
Â  Â  <label>ìƒ‰ìƒ</label>
Â  Â  <div class="color-grid" id="colorGrid"></div>
Â  Â  <div class="btn-row">
Â  Â  Â  <button class="btn-primary" onclick="saveBlock()">ì €ì¥</button>
Â  Â  Â  <button class="btn-danger" onclick="deleteBlock()">ì‚­ì œ</button>
Â  Â  Â  <button class="btn-secondary" onclick="closeOverlay('editOverlay')">ì·¨ì†Œ</button>
Â  Â  </div>
Â  </div>
</div>

<!-- ADD MODAL -->
<div class="overlay" id="addOverlay">
Â  <div class="modal">
Â  Â  <h2>â• ì¼ì • ì¶”ê°€</h2>
Â  Â  <p>ìƒˆ ì¼ì • ì •ë³´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”</p>
Â  Â  <label>í™œë™ ì´ë¦„</label>
Â  Â  <input type="text" id="addName" placeholder="ì˜ˆ: í”¼ì•„ë…¸">
Â  Â  <label>ì•„ì´ì½˜ (ì´ëª¨ì§€)</label>
Â  Â  <input type="text" id="addIcon" placeholder="ì˜ˆ: ğŸ¹">
Â  Â  <label>ì‹œê°„</label>
Â  Â  <div class="modal-row">
Â  Â  Â  <div><label style="font-size:0.75rem;color:#999;margin-bottom:4px">ì‹œì‘</label><input type="text" id="addStart" placeholder="3:00"></div>
Â  Â  Â  <div><label style="font-size:0.75rem;color:#999;margin-bottom:4px">ì¢…ë£Œ</label><input type="text" id="addEnd" placeholder="4:00"></div>
Â  Â  </div>
Â  Â  <label>ìƒ‰ìƒ</label>
Â  Â  <div class="color-grid" id="addColorGrid"></div>
Â  Â  <div class="btn-row">
Â  Â  Â  <button class="btn-primary" onclick="saveAdd()">ì¶”ê°€</button>
Â  Â  Â  <button class="btn-secondary" onclick="closeOverlay('addOverlay')">ì·¨ì†Œ</button>
Â  Â  </div>
Â  </div>
</div>

<script>
const EDIT_PASSWORD = "1234";
const STORAGE_KEY = "kidSchedule_v3";
const PALETTE = ["#FF6B6B","#FF8E53","#F7B731","#26de81","#4ECDC4","#45B7D1","#a29bfe","#fd79a8","#e17055","#b2bec3","#6c5ce7","#00cec9","#fdcb6e","#55efc4","#fab1a0"];

const DEFAULT = {
Â  "ì›”":[
Â  Â  {type:"school",Â  Â time:"1:30",Â  Â  Â  label:"í•˜êµ",Â  Â  Â  icon:"ğŸ«", color:"#FF6B6B"},
Â  Â  {type:"english",Â  time:"1:40â€“2:40", label:"ì˜ì–´",Â  Â  Â  icon:"ğŸ“š", color:"#4ECDC4"},
Â  Â  {type:"math",Â  Â  Â time:"2:50â€“4:30", label:"ìˆ˜í•™",Â  Â  Â  icon:"ğŸ“", color:"#45B7D1"},
Â  Â  {type:"home",Â  Â  Â time:"4:30â€“5:15", label:"ì§‘",Â  Â  Â icon:"ğŸ ", color:"#b2bec3"},
Â  Â  {type:"taekwondo",time:"5:30â€“6:20", label:"íƒœê¶Œë„",Â  Â  icon:"ğŸ¥‹", color:"#F7B731"},
Â  ],
Â  "í™”":[
Â  Â  {type:"school",Â  Â time:"2:20",Â  Â  Â  label:"í•˜êµ",Â  Â  Â  icon:"ğŸ«", color:"#FF6B6B"},
Â  Â  {type:"soccer",Â  Â time:"2:30â€“3:55", label:"ì¶•êµ¬",Â  Â  Â  icon:"âš½", color:"#26de81"},
Â  Â  {type:"english",Â  time:"4:00â€“5:00", label:"ì˜ì–´",Â  Â  Â  icon:"ğŸ“š", color:"#4ECDC4"},
Â  Â  {type:"taekwondo",time:"5:30â€“6:20", label:"íƒœê¶Œë„",Â  Â  icon:"ğŸ¥‹", color:"#F7B731"},
Â  ],
Â  "ìˆ˜":[
Â  Â  {type:"school",Â  Â time:"1:30",Â  Â  Â  label:"í•˜êµ",Â  Â  Â  icon:"ğŸ«", color:"#FF6B6B"},
Â  Â  {type:"violin",Â  Â time:"1:40â€“2:30", label:"ë°”ì´ì˜¬ë¦°",Â  icon:"ğŸ»", color:"#a29bfe"},
Â  Â  {type:"english",Â  time:"2:40â€“3:40", label:"ì˜ì–´",Â  Â  Â  icon:"ğŸ“š", color:"#4ECDC4"},
Â  Â  {type:"taekwondo",time:"4:30â€“5:20", label:"íƒœê¶Œë„",Â  Â  icon:"ğŸ¥‹", color:"#F7B731"},
Â  ],
Â  "ëª©":[
Â  Â  {type:"school",Â  Â time:"1:30",Â  Â  Â  label:"í•˜êµ",Â  Â  Â  icon:"ğŸ«", color:"#FF6B6B"},
Â  Â  {type:"english",Â  time:"1:40â€“3:00", label:"ì˜ì–´",Â  Â  Â  icon:"ğŸ“š", color:"#4ECDC4"},
Â  Â  {type:"hanuri",Â  Â time:"3:10â€“4:30", label:"í•œìš°ë¦¬ë…¼ìˆ ", icon:"ğŸ“", color:"#fd79a8"},
Â  Â  {type:"taekwondo",time:"5:30â€“6:20", label:"íƒœê¶Œë„",Â  Â  icon:"ğŸ¥‹", color:"#F7B731"},
Â  ],
Â  "ê¸ˆ":[
Â  Â  {type:"school",Â  Â time:"1:30",Â  Â  Â  label:"í•˜êµ",Â  Â  Â  icon:"ğŸ«", color:"#FF6B6B"},
Â  Â  {type:"english",Â  time:"1:40â€“2:45", label:"ì˜ì–´",Â  Â  Â  icon:"ğŸ“š", color:"#4ECDC4"},
Â  Â  {type:"art",Â  Â  Â  time:"3:00â€“4:20", label:"ë¯¸ìˆ ",Â  Â  Â  icon:"ğŸ¨", color:"#e17055"},
Â  Â  {type:"home",Â  Â  Â time:"4:30â€“5:40", label:"ì§‘",Â  Â  Â  Â  icon:"ğŸ ", color:"#b2bec3"},
Â  Â  {type:"swim",Â  Â  Â time:"5:45â€“7:00", label:"ìˆ˜ì˜",Â  Â  Â  icon:"ğŸŠ", color:"#00cec9"},
Â  ],
};

let schedule = JSON.parse(JSON.stringify(DEFAULT));
let editMode = false;
let editTarget = null;
let addDay = null;
let selColor = PALETTE[0];
let addSelColor = PALETTE[4];

// â”€â”€ View Mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let viewMode = "card";
function setView(mode, btn) {
Â  viewMode = mode;
Â  document.querySelectorAll(".view-btn").forEach(b=>b.classList.remove("active"));
Â  btn.classList.add("active");
Â  document.getElementById("schedule").style.display = mode==="card" ? "" : "none";
Â  document.getElementById("weekWrap").style.displayÂ  = mode==="week" ? "" : "none";
Â  mode==="week" ? renderWeek() : render();
}

function renderWeek() {
Â  const tbl = document.getElementById("weekTable");
Â  tbl.innerHTML = "";
Â  Object.entries(schedule).forEach(([day, items]) => {
Â  Â  const col = document.createElement("div");
Â  Â  col.className = "week-col" + (editMode?" edit-active":"");
Â  Â  col.innerHTML = `<div class="week-day-title"><div class="week-badge">${day}</div>${day}ìš”ì¼</div>`;
Â  Â  items.forEach((item, idx) => {
Â  Â  Â  if (item.type === "school") {
Â  Â  Â  Â  const el = document.createElement("div");
Â  Â  Â  Â  el.className = "week-school";
Â  Â  Â  Â  el.style.background = item.color;
Â  Â  Â  Â  el.innerHTML = `<span>${item.icon}</span><span>${item.label}</span><span style="margin-left:auto;font-size:0.75rem;opacity:0.85">${item.time}</span>`;
Â  Â  Â  Â  if (editMode) el.onclick = () => openEdit(day, idx);
Â  Â  Â  Â  col.appendChild(el);
Â  Â  Â  } else {
Â  Â  Â  Â  const el = document.createElement("div");
Â  Â  Â  Â  el.className = "week-block";
Â  Â  Â  Â  el.style.background = item.color;
Â  Â  Â  Â  el.style.color = textColor(item.color);
Â  Â  Â  Â  el.innerHTML = `
Â  Â  Â  Â  Â  <div class="week-block-top">
Â  Â  Â  Â  Â  Â  <span class="week-block-icon">${item.icon}</span>
Â  Â  Â  Â  Â  Â  <span class="week-block-name">${item.label}</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="week-block-time">${item.time}</div>`;
Â  Â  Â  Â  if (editMode) el.onclick = () => openEdit(day, idx);
Â  Â  Â  Â  col.appendChild(el);
Â  Â  Â  }
Â  Â  });
Â  Â  if (editMode) {
Â  Â  Â  const addBtn = document.createElement("button");
Â  Â  Â  addBtn.className = "add-btn";
Â  Â  Â  addBtn.style.display = "flex";
Â  Â  Â  addBtn.textContent = "+ ì¶”ê°€";
Â  Â  Â  addBtn.onclick = () => openAdd(day);
Â  Â  Â  col.appendChild(addBtn);
Â  Â  }
Â  Â  tbl.appendChild(col);
Â  });
Â  renderLegend();
}

// â”€â”€ Storage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function save() {
Â  try { localStorage.setItem(STORAGE_KEY, JSON.stringify(schedule)); } catch(e){}
}
function load() {
Â  try { const r = localStorage.getItem(STORAGE_KEY); if(r) schedule = JSON.parse(r); } catch(e){}
}

// â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function lum(hex) {
Â  const r=parseInt(hex.slice(1,3),16)/255, g=parseInt(hex.slice(3,5),16)/255, b=parseInt(hex.slice(5,7),16)/255;
Â  return 0.299*r+0.587*g+0.114*b;
}
function textColor(hex) { return lum(hex)>0.45?"#222":"white"; }

function rerender() { viewMode==="week" ? renderWeek() : render(); }

function render() {
Â  const grid = document.getElementById("schedule");
Â  grid.innerHTML = "";
Â  Object.entries(schedule).forEach(([day, items]) => {
Â  Â  const card = document.createElement("div");
Â  Â  card.className = "day-card" + (editMode?" edit-active":"");
Â  Â  card.innerHTML = `<div class="day-title"><div class="day-badge">${day}</div>${day}ìš”ì¼</div>`;

Â  Â  items.forEach((item, idx) => {
Â  Â  Â  if (item.type === "school") {
Â  Â  Â  Â  const el = document.createElement("div");
Â  Â  Â  Â  el.className = "school-row";
Â  Â  Â  Â  el.style.background = item.color;
Â  Â  Â  Â  el.innerHTML = `<span>${item.icon}</span><span>${item.label}</span><span class="school-time">${item.time}</span>`;
Â  Â  Â  Â  if (editMode) el.onclick = () => openEdit(day, idx);
Â  Â  Â  Â  card.appendChild(el);
Â  Â  Â  } else {
Â  Â  Â  Â  const el = document.createElement("div");
Â  Â  Â  Â  el.className = "block";
Â  Â  Â  Â  el.style.background = item.color;
Â  Â  Â  Â  el.style.color = textColor(item.color);
Â  Â  Â  Â  el.innerHTML = `<span class="block-icon">${item.icon}</span><span class="block-name">${item.label}</span><span class="block-time">${item.time}</span>`;
Â  Â  Â  Â  if (editMode) el.onclick = () => openEdit(day, idx);
Â  Â  Â  Â  card.appendChild(el);
Â  Â  Â  }
Â  Â  });

Â  Â  const addBtn = document.createElement("button");
Â  Â  addBtn.className = "add-btn";
Â  Â  addBtn.textContent = "+ ì¼ì • ì¶”ê°€";
Â  Â  addBtn.onclick = () => openAdd(day);
Â  Â  card.appendChild(addBtn);
Â  Â  grid.appendChild(card);
Â  });
Â  renderLegend();
}

function renderLegend() {
Â  const seen = new Map();
Â  Object.values(schedule).flat().forEach(i => { if(!seen.has(i.label)) seen.set(i.label,i.color); });
Â  const leg = document.getElementById("legend");
Â  leg.innerHTML = "";
Â  seen.forEach((c,l) => { leg.innerHTML += `<div class="legend-item"><div class="legend-dot" style="background:${c}"></div>${l}</div>`; });
}

// â”€â”€ Edit Mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleEdit() {
Â  if (!editMode) {
Â  Â  document.getElementById("pwOverlay").classList.add("show");
Â  Â  document.getElementById("pwInput").value = "";
Â  Â  document.getElementById("pwError").textContent = "";
Â  Â  setTimeout(()=>document.getElementById("pwInput").focus(),100);
Â  } else exitEdit();
}
function checkPw() {
Â  if (document.getElementById("pwInput").value === EDIT_PASSWORD) {
Â  Â  closeOverlay("pwOverlay");
Â  Â  editMode = true;
Â  Â  document.getElementById("editBanner").classList.add("show");
Â  Â  document.getElementById("editFab").classList.add("active");
Â  Â  document.getElementById("editFab").textContent = "ğŸ”’";
Â  Â  rerender();
Â  } else {
Â  Â  document.getElementById("pwError").textContent = "âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤";
Â  }
}
function exitEdit() {
Â  editMode = false;
Â  document.getElementById("editBanner").classList.remove("show");
Â  document.getElementById("editFab").classList.remove("active");
Â  document.getElementById("editFab").textContent = "âœï¸";
Â  rerender();
}

// â”€â”€ Color Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildColors(id, current, cb) {
Â  const g = document.getElementById(id);
Â  g.innerHTML = "";
Â  PALETTE.forEach(c => {
Â  Â  const d = document.createElement("div");
Â  Â  d.className = "color-opt"+(c===current?" selected":"");
Â  Â  d.style.background = c;
Â  Â  d.onclick = () => { g.querySelectorAll(".color-opt").forEach(x=>x.classList.remove("selected")); d.classList.add("selected"); cb(c); };
Â  Â  g.appendChild(d);
Â  });
}

// â”€â”€ Edit Block â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openEdit(day, idx) {
Â  editTarget = {day, idx};
Â  const item = schedule[day][idx];
Â  selColor = item.color;
Â  document.getElementById("editName").valueÂ  = item.label;
Â  document.getElementById("editIcon").valueÂ  = item.icon;
Â  const parts = item.time.split("â€“");
Â  document.getElementById("editStart").value = parts[0]||"";
Â  document.getElementById("editEnd").valueÂ  Â = parts[1]||"";
Â  buildColors("colorGrid", selColor, c=>{ selColor=c; });
Â  document.getElementById("editOverlay").classList.add("show");
}
function saveBlock() {
Â  if (!editTarget) return;
Â  const item = schedule[editTarget.day][editTarget.idx];
Â  const nameÂ  = document.getElementById("editName").value.trim();
Â  if (!name) return;
Â  const start = document.getElementById("editStart").value.trim();
Â  const endÂ  Â = document.getElementById("editEnd").value.trim();
Â  item.label = name;
Â  item.iconÂ  = document.getElementById("editIcon").value.trim() || item.icon;
Â  item.color = selColor;
Â  item.timeÂ  = end ? `${start}â€“${end}` : start;
Â  save(); closeOverlay("editOverlay"); rerender(); toast("âœ… ì €ì¥ëì–´ìš”!");
}
function deleteBlock() {
Â  if (!editTarget) return;
Â  schedule[editTarget.day].splice(editTarget.idx, 1);
Â  save(); closeOverlay("editOverlay"); rerender(); toast("ğŸ—‘ï¸ ì‚­ì œëì–´ìš”!");
}

// â”€â”€ Add Block â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openAdd(day) {
Â  addDay = day; addSelColor = PALETTE[4];
Â  ["addName","addIcon","addStart","addEnd"].forEach(id=>document.getElementById(id).value="");
Â  buildColors("addColorGrid", addSelColor, c=>{ addSelColor=c; });
Â  document.getElementById("addOverlay").classList.add("show");
}
function saveAdd() {
Â  const nameÂ  = document.getElementById("addName").value.trim();
Â  if (!name) return;
Â  const iconÂ  = document.getElementById("addIcon").value.trim()||"ğŸ“Œ";
Â  const start = document.getElementById("addStart").value.trim();
Â  const endÂ  Â = document.getElementById("addEnd").value.trim();
Â  schedule[addDay].push({ type:name, label:name, icon, color:addSelColor, time:end?`${start}â€“${end}`:start });
Â  schedule[addDay].sort((a,b)=>t2m(a.time)-t2m(b.time));
Â  save(); closeOverlay("addOverlay"); rerender(); toast("âœ… ì¶”ê°€ëì–´ìš”!");
}

// â”€â”€ Utils â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function t2m(t) { const s=t.split("â€“")[0],[h,m]=s.split(":").map(Number); return (h||0)*60+(m||0); }
function closeOverlay(id) { document.getElementById(id).classList.remove("show"); }
function setSize(s, btn) {
Â  document.body.classList.remove("size-lg","size-xl");
Â  if(s!=="normal") document.body.classList.add("size-"+s);
Â  document.querySelectorAll(".ctrl-btn").forEach(b=>b.classList.remove("active"));
Â  btn.classList.add("active");
}
function toast(msg="âœ… ì €ì¥ëì–´ìš”!") {
Â  const t=document.getElementById("toast"); t.textContent=msg;
Â  t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),2200);
}

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
load(); render();
</script>
</body>
</html>
